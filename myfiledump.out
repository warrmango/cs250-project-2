0x0000000000000000: 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F  .#include <stdio
0x0000000000000010: 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74  .h>.#include <st
0x0000000000000020: 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65  ring.h>.#include
0x0000000000000030: 20 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69   <stdlib.h>..voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 20 20 20 20 46 49 4C 45 20 2A 20 66 64 20 3D  .    FILE * fd =
0x0000000000000070: 20 73 74 64 6F 75 74 3B 0A 20 20 20 20 69 6E 74   stdout;.    int
0x0000000000000080: 20 6C 69 6E 65 4E 75 6D 20 3D 20 6C 65 6E 20 2F   lineNum = len /
0x0000000000000090: 20 31 36 3B 0A 20 20 20 20 69 6E 74 20 72 65 6D   16;.    int rem
0x00000000000000A0: 61 69 6E 64 65 72 20 3D 20 6C 65 6E 20 25 20 31  ainder = len % 1
0x00000000000000B0: 36 3B 0A 0A 20 20 20 20 2F 2F 65 76 65 72 79 20  6;..    //every 
0x00000000000000C0: 31 36 20 62 79 74 65 73 2C 20 63 72 65 61 74 65  16 bytes, create
0x00000000000000D0: 20 61 20 6C 69 6E 65 20 6F 66 20 64 75 6D 70 20   a line of dump 
0x00000000000000E0: 6F 75 74 70 75 74 20 69 6E 20 68 65 78 61 64 65  output in hexade
0x00000000000000F0: 63 69 6D 61 6C 0A 20 20 20 20 66 6F 72 20 28 69  cimal.    for (i
0x0000000000000100: 6E 74 20 6A 20 3D 20 30 3B 20 6A 20 3C 20 6C 69  nt j = 0; j < li
0x0000000000000110: 6E 65 4E 75 6D 3B 20 6A 2B 2B 29 20 7B 0A 0A 20  neNum; j++) {.. 
0x0000000000000120: 20 20 20 20 20 20 20 2F 2F 70 72 69 6E 74 20 73         //print s
0x0000000000000130: 74 61 72 74 69 6E 67 20 61 64 64 72 65 73 73 20  tarting address 
0x0000000000000140: 6F 66 20 62 79 74 65 73 20 69 6E 20 74 68 69 73  of bytes in this
0x0000000000000150: 20 6C 69 6E 65 20 6F 66 20 6F 75 74 70 75 74 0A   line of output.
0x0000000000000160: 20 20 20 20 20 20 20 20 66 70 72 69 6E 74 66 28          fprintf(
0x0000000000000170: 66 64 2C 20 22 30 78 25 30 31 36 6C 58 3A 20 22  fd, "0x%016lX: "
0x0000000000000180: 2C 20 28 75 6E 73 69 67 6E 65 64 20 6C 6F 6E 67  , (unsigned long
0x0000000000000190: 29 28 6A 20 2A 20 31 36 29 29 3B 0A 0A 20 20 20  )(j * 16));..   
0x00000000000001A0: 20 20 20 20 20 2F 2F 70 72 69 6E 74 20 73 69 78       //print six
0x00000000000001B0: 74 65 65 6E 20 62 79 74 65 73 20 69 6E 20 6D 65  teen bytes in me
0x00000000000001C0: 6D 6F 72 79 20 66 72 6F 6D 20 73 74 61 72 74 69  mory from starti
0x00000000000001D0: 6E 67 20 61 64 64 72 65 73 73 0A 20 20 20 20 20  ng address.     
0x00000000000001E0: 20 20 20 66 6F 72 20 28 69 6E 74 20 69 20 3D 20     for (int i = 
0x00000000000001F0: 30 3B 20 69 20 3C 20 31 36 3B 20 69 2B 2B 29 20  0; i < 16; i++) 
0x0000000000000200: 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20 69 6E  {.            in
0x0000000000000210: 74 20 63 20 3D 20 70 5B 69 20 2B 20 6A 20 2A 20  t c = p[i + j * 
0x0000000000000220: 31 36 5D 20 26 20 30 78 46 46 3B 0A 20 20 20 20  16] & 0xFF;.    
0x0000000000000230: 20 20 20 20 20 20 20 20 66 70 72 69 6E 74 66 28          fprintf(
0x0000000000000240: 66 64 2C 20 22 25 30 32 58 20 22 2C 20 63 29 3B  fd, "%02X ", c);
0x0000000000000250: 0A 20 20 20 20 20 20 20 20 7D 0A 20 20 20 20 20  .        }.     
0x0000000000000260: 20 20 20 66 70 72 69 6E 74 66 28 66 64 2C 20 22     fprintf(fd, "
0x0000000000000270: 20 22 29 3B 0A 0A 20 20 20 20 20 20 20 20 2F 2F   ");..        //
0x0000000000000280: 67 6F 69 6E 67 20 74 68 72 6F 75 67 68 20 74 68  going through th
0x0000000000000290: 65 20 31 36 20 62 79 74 65 73 20 61 6E 64 20 70  e 16 bytes and p
0x00000000000002A0: 72 69 6E 74 69 6E 67 20 65 61 63 68 20 62 79 74  rinting each byt
0x00000000000002B0: 65 20 61 73 20 61 6E 0A 20 20 20 20 20 20 20 20  e as an.        
0x00000000000002C0: 2F 2F 41 53 43 49 49 20 63 68 61 72 63 74 65 72  //ASCII charcter
0x00000000000002D0: 20 69 66 20 70 6F 73 73 69 62 6C 65 2C 20 6F 74   if possible, ot
0x00000000000002E0: 68 65 72 77 69 73 65 20 70 72 69 6E 74 20 74 68  herwise print th
0x00000000000002F0: 65 20 22 2E 22 0A 20 20 20 20 20 20 20 20 66 6F  e ".".        fo
0x0000000000000300: 72 20 28 69 6E 74 20 69 20 3D 20 30 3B 20 69 20  r (int i = 0; i 
0x0000000000000310: 3C 20 31 36 3B 20 69 2B 2B 29 20 7B 0A 20 20 20  < 16; i++) {.   
0x0000000000000320: 20 20 20 20 20 20 20 20 20 69 6E 74 20 63 20 3D           int c =
0x0000000000000330: 20 2A 28 70 20 2B 20 69 20 2B 20 6A 20 2A 20 31   *(p + i + j * 1
0x0000000000000340: 36 29 20 26 20 30 78 46 46 3B 0A 20 20 20 20 20  6) & 0xFF;.     
0x0000000000000350: 20 20 20 20 20 20 20 69 66 20 28 63 20 3C 20 33         if (c < 3
0x0000000000000360: 32 20 7C 7C 20 63 20 3E 3D 20 31 32 37 29 20 63  2 || c >= 127) c
0x0000000000000370: 20 3D 20 27 2E 27 3B 0A 20 20 20 20 20 20 20 20   = '.';.        
0x0000000000000380: 20 20 20 20 66 70 72 69 6E 74 66 28 66 64 2C 20      fprintf(fd, 
0x0000000000000390: 22 25 63 22 2C 20 63 29 3B 0A 0A 20 20 20 20 20  "%c", c);..     
0x00000000000003A0: 20 20 20 7D 0A 20 20 20 20 20 20 20 20 66 70 72     }.        fpr
0x00000000000003B0: 69 6E 74 66 28 66 64 2C 20 22 5C 6E 22 29 3B 0A  intf(fd, "\n");.
0x00000000000003C0: 20 20 20 20 7D 0A 0A 20 20 20 20 2F 2F 70 72 69      }..    //pri
0x00000000000003D0: 6E 74 20 61 6E 20 65 78 74 72 61 20 6C 69 6E 65  nt an extra line
0x00000000000003E0: 20 77 69 74 68 20 66 65 77 65 72 20 74 68 61 6E   with fewer than
0x00000000000003F0: 20 31 36 20 61 64 72 65 73 73 65 73 20 77 69 74   16 adresses wit
0x0000000000000400: 68 0A 20 20 20 20 2F 2F 74 68 65 20 73 69 6D 69  h.    //the simi
0x0000000000000410: 6C 61 72 20 70 72 6F 63 65 73 73 20 6C 69 6B 65  lar process like
0x0000000000000420: 20 74 68 65 20 73 69 6E 67 6C 65 20 73 74 65 70   the single step
0x0000000000000430: 20 69 74 65 72 61 74 69 6F 6E 20 61 62 6F 76 65   iteration above
0x0000000000000440: 0A 20 20 20 20 69 66 20 28 72 65 6D 61 69 6E 64  .    if (remaind
0x0000000000000450: 65 72 20 21 3D 20 30 29 20 7B 0A 20 20 20 20 20  er != 0) {.     
0x0000000000000460: 20 20 20 66 70 72 69 6E 74 66 28 66 64 2C 20 22     fprintf(fd, "
0x0000000000000470: 30 78 25 30 31 36 6C 58 3A 20 22 2C 20 28 75 6E  0x%016lX: ", (un
0x0000000000000480: 73 69 67 6E 65 64 20 6C 6F 6E 67 29 28 6C 69 6E  signed long)(lin
0x0000000000000490: 65 4E 75 6D 20 2A 20 31 36 29 29 3B 0A 0A 20 20  eNum * 16));..  
0x00000000000004A0: 20 20 20 20 20 20 66 6F 72 20 28 69 6E 74 20 69        for (int i
0x00000000000004B0: 20 3D 20 30 3B 20 69 20 3C 20 31 36 3B 20 69 2B   = 0; i < 16; i+
0x00000000000004C0: 2B 29 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20  +) {.           
0x00000000000004D0: 20 69 66 20 28 69 20 3C 72 65 6D 61 69 6E 64 65   if (i <remainde
0x00000000000004E0: 72 29 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20  r) {.           
0x00000000000004F0: 20 20 20 20 20 69 6E 74 20 63 20 3D 20 70 5B 69       int c = p[i
0x0000000000000500: 20 2B 20 6C 69 6E 65 4E 75 6D 20 2A 20 31 36 5D   + lineNum * 16]
0x0000000000000510: 20 26 20 30 78 46 46 3B 0A 20 20 20 20 20 20 20   & 0xFF;.       
0x0000000000000520: 20 20 20 20 20 20 20 20 20 66 70 72 69 6E 74 66           fprintf
0x0000000000000530: 28 66 64 2C 20 22 25 30 32 58 20 22 2C 20 63 29  (fd, "%02X ", c)
0x0000000000000540: 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A  ;.            }.
0x0000000000000550: 20 20 20 20 20 20 20 20 20 20 20 20 65 6C 73 65              else
0x0000000000000560: 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20 20   {.             
0x0000000000000570: 20 20 20 66 70 72 69 6E 74 66 28 66 64 2C 20 22     fprintf(fd, "
0x0000000000000580: 20 20 20 22 29 3B 0A 20 20 20 20 20 20 20 20 20     ");.         
0x0000000000000590: 20 20 20 7D 0A 20 20 20 20 20 20 20 20 7D 0A 20     }.        }. 
0x00000000000005A0: 20 20 20 20 20 20 20 66 70 72 69 6E 74 66 28 66         fprintf(f
0x00000000000005B0: 64 2C 20 22 20 22 29 3B 0A 0A 20 20 20 20 20 20  d, " ");..      
0x00000000000005C0: 20 20 66 6F 72 20 28 69 6E 74 20 69 20 3D 20 30    for (int i = 0
0x00000000000005D0: 3B 20 69 20 3C 20 31 36 3B 20 69 2B 2B 29 20 7B  ; i < 16; i++) {
0x00000000000005E0: 0A 20 20 20 20 20 20 20 20 20 20 20 20 69 66 20  .            if 
0x00000000000005F0: 28 69 20 3C 72 65 6D 61 69 6E 64 65 72 29 20 7B  (i <remainder) {
0x0000000000000600: 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20  .               
0x0000000000000610: 20 69 6E 74 20 63 20 3D 20 2A 28 70 20 2B 20 69   int c = *(p + i
0x0000000000000620: 20 2B 20 6C 69 6E 65 4E 75 6D 20 2A 20 31 36 29   + lineNum * 16)
0x0000000000000630: 20 26 20 30 78 46 46 3B 0A 20 20 20 20 20 20 20   & 0xFF;.       
0x0000000000000640: 20 20 20 20 20 20 20 20 20 69 66 20 28 63 20 3C           if (c <
0x0000000000000650: 20 33 32 20 7C 7C 20 63 20 3E 3D 20 31 32 37 29   32 || c >= 127)
0x0000000000000660: 20 63 20 3D 20 27 2E 27 3B 0A 20 20 20 20 20 20   c = '.';.      
0x0000000000000670: 20 20 20 20 20 20 20 20 20 20 66 70 72 69 6E 74            fprint
0x0000000000000680: 66 28 66 64 2C 20 22 25 63 22 2C 20 63 29 3B 0A  f(fd, "%c", c);.
0x0000000000000690: 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A 20 20              }.  
0x00000000000006A0: 20 20 20 20 20 20 7D 0A 20 20 20 20 20 20 20 20        }.        
0x00000000000006B0: 66 70 72 69 6E 74 66 28 66 64 2C 20 22 5C 6E 22  fprintf(fd, "\n"
0x00000000000006C0: 29 3B 0A 20 20 20 20 7D 0A 0A 09 0A 7D 0A 0A 69  );.    }....}..i
0x00000000000006D0: 6E 74 0A 6D 61 69 6E 28 69 6E 74 20 61 72 67 63  nt.main(int argc
0x00000000000006E0: 2C 20 63 68 61 72 20 2A 2A 61 72 67 76 29 20 7B  , char **argv) {
0x00000000000006F0: 0A 20 20 46 49 4C 45 20 2A 66 69 6C 65 20 3D 20  .  FILE *file = 
0x0000000000000700: 66 6F 70 65 6E 28 61 72 67 76 5B 31 5D 2C 20 22  fopen(argv[1], "
0x0000000000000710: 72 22 29 3B 0A 20 20 69 66 20 28 21 66 69 6C 65  r");.  if (!file
0x0000000000000720: 29 20 7B 0A 20 20 20 20 70 72 69 6E 74 66 28 22  ) {.    printf("
0x0000000000000730: 45 72 72 6F 72 20 6F 70 65 6E 69 6E 67 20 66 69  Error opening fi
0x0000000000000740: 6C 65 20 5C 22 69 6E 76 61 6C 69 64 66 69 6C 65  le \"invalidfile
0x0000000000000750: 5C 22 5C 6E 22 29 3B 0A 20 20 20 20 72 65 74 75  \"\n");.    retu
0x0000000000000760: 72 6E 20 30 3B 0A 20 20 7D 0A 20 20 66 73 65 65  rn 0;.  }.  fsee
0x0000000000000770: 6B 28 66 69 6C 65 2C 20 30 2C 20 53 45 45 4B 5F  k(file, 0, SEEK_
0x0000000000000780: 45 4E 44 29 3B 20 20 0A 20 20 69 6E 74 20 66 69  END);  .  int fi
0x0000000000000790: 6C 65 53 69 7A 65 20 3D 20 66 74 65 6C 6C 28 66  leSize = ftell(f
0x00000000000007A0: 69 6C 65 29 3B 0A 20 20 2F 2F 6D 6F 76 65 20 74  ile);.  //move t
0x00000000000007B0: 68 65 20 70 6F 69 6E 74 65 72 20 74 6F 20 74 68  he pointer to th
0x00000000000007C0: 65 20 65 6E 64 20 6F 66 20 66 69 6C 65 20 61 6E  e end of file an
0x00000000000007D0: 64 20 72 65 63 6F 72 64 20 74 68 65 20 74 6F 74  d record the tot
0x00000000000007E0: 61 6C 20 73 69 7A 65 20 6F 66 20 74 68 69 73 20  al size of this 
0x00000000000007F0: 66 69 6C 65 0A 20 20 20 66 73 65 65 6B 28 66 69  file.   fseek(fi
0x0000000000000800: 6C 65 2C 20 30 2C 20 53 45 45 4B 5F 53 45 54 29  le, 0, SEEK_SET)
0x0000000000000810: 3B 20 0A 20 20 2F 2F 72 65 73 65 74 20 70 6F 69  ; .  //reset poi
0x0000000000000820: 6E 74 65 72 20 74 6F 20 74 68 65 20 62 65 67 69  nter to the begi
0x0000000000000830: 6E 6E 69 6E 67 0A 20 20 69 66 20 28 61 72 67 63  nning.  if (argc
0x0000000000000840: 20 3D 3D 20 33 29 20 7B 0A 20 20 20 20 66 69 6C   == 3) {.    fil
0x0000000000000850: 65 53 69 7A 65 20 3D 20 66 69 6C 65 53 69 7A 65  eSize = fileSize
0x0000000000000860: 20 3E 20 61 74 6F 69 28 61 72 67 76 5B 32 5D 29   > atoi(argv[2])
0x0000000000000870: 20 3F 20 61 74 6F 69 28 61 72 67 76 5B 32 5D 29   ? atoi(argv[2])
0x0000000000000880: 20 3A 20 66 69 6C 65 53 69 7A 65 3B 0A 20 20 7D   : fileSize;.  }
0x0000000000000890: 0A 20 20 2F 2F 6D 61 6B 65 20 73 75 72 65 20 74  .  //make sure t
0x00000000000008A0: 68 65 20 73 69 7A 65 20 69 73 20 70 72 6F 70 65  he size is prope
0x00000000000008B0: 72 0A 20 20 63 68 61 72 20 62 75 66 66 5B 66 69  r.  char buff[fi
0x00000000000008C0: 6C 65 53 69 7A 65 20 2B 20 31 5D 3B 0A 20 20 66  leSize + 1];.  f
0x00000000000008D0: 72 65 61 64 28 62 75 66 66 2C 20 66 69 6C 65 53  read(buff, fileS
0x00000000000008E0: 69 7A 65 2C 20 31 2C 20 66 69 6C 65 29 3B 0A 20  ize, 1, file);. 
0x00000000000008F0: 20 66 63 6C 6F 73 65 28 66 69 6C 65 29 3B 0A 20   fclose(file);. 
0x0000000000000900: 20 66 69 6C 65 64 75 6D 70 28 62 75 66 66 2C 66   filedump(buff,f
0x0000000000000910: 69 6C 65 53 69 7A 65 29 3B 0A 20 20 2F 2F 70 75  ileSize);.  //pu
0x0000000000000920: 74 20 74 68 65 20 72 65 73 75 6C 74 20 6F 66 20  t the result of 
0x0000000000000930: 66 69 6C 65 44 75 6D 70 20 69 6E 74 6F 20 61 6E  fileDump into an
0x0000000000000940: 20 61 72 72 61 79 0A 7D 0A 0A 0A                  array.}...
